setwd("~/2022SpringCodingCamp/DarianWilliams")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
https://raw.githubusercontent.com/mathelab/AltreDataRepo/master/DNaseEncodeExample.csv
DNaseEncodeExample.csv
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
setwd("~/2022SpringCodingCamp/DarianWilliams")
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
View(csvfile)
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
View(samplePeaks)
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,minreps = 2)
DNaseEncodeExample <- read.csv("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata/DNaseEncodeExample.csv")
View(DNaseEncodeExample)
samplePeaks <- loadBedFiles(csvfile)
library(altere)
library(ALTRE)
samplePeaks <- loadBedFiles(csvfile)
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
View(samplePeaks)
`show_col_types = FALSE`
show_col_types = FALSE`
A549_ENCFF001CLE_chr21 <- read.csv("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata/A549_ENCFF001CLE_chr21.bam", sep="")
View(A549_ENCFF001CLE_chr21)
A549_ENCFF001CLJ_chr21 <- read.csv("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata/A549_ENCFF001CLJ_chr21.bam", sep="")
View(A549_ENCFF001CLJ_chr21)
A549_ENCFF001CLJ_chr21 <- read.csv("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata/A549_ENCFF001CLJ_chr21.bam", sep="")
View(A549_ENCFF001CLJ_chr21)
plotConsensusPeaks(samplepeaks = consensusPeaks)
> View(samplePeaks)
> View(samplePeaks)
> View(samplePeaks)
> View(samplePeaks)
> View(samplePeaks)
library(ALTRE)
> View(samplePeaks)
View(samplePeaks)
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks, minreps = 2)
consensusPeaks <- getConsensusPeaks(samplePeaks,minreps = 2)
View(samplePeaks)
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
View(samplePeaks)
View(samplePeaks)
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
spec(1)
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks, minreps = 2)
View(samplePeaks)
View(samplePeaks)
setwd("~/2022SpringCodingCamp/DarianWilliams")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
> setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
csvfile
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
plotConsensusPeaks(samplepeaks = consensusPeaks)
TSSannot <- getTSS()
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
plotConsensusPeaks(samplepeaks = consensusPeaks)
TSSannot <- getTSS()
consensusPeaksAnnotated <- combineAnnotatePeaks(conspeaks = consensusPeaks,
TSS = TSSannot,
merge = TRUE,
regionspecific = TRUE,
distancefromTSSdist = 1500,
distancefromTSSprox = 1000)
plotCombineAnnotatePeaks(consensusPeaksAnnotated)
consensusPeaksCounts <- getCounts(annotpeaks = consensusPeaksAnnotated,
sampleinfo = csvfile,
reference = 'SAEC',
chrom = 'chr21')
plotGetCounts(consensusPeaksCounts)
alteredPeaks <- countanalysis(counts = consensusPeaksCounts,
pval = 0.01,
lfcvalue = 1)
alteredPeaksCategorized <- categAltrePeaks(alteredPeaks,
lfctypespecific = 1.5,
lfcshared = 1.2,
pvaltypespecific = 0.01,
pvalshared = 0.05)
plotCountAnalysis(alteredPeaksCategorized)
plotDistCountAnalysis(alteredPeaksCategorized, consensusPeaksCounts)
comparePeaksAnalysisResults <- comparePeaksAltre(alteredPeaksCategorized)
plotCompareMethodsAll(comparePeaksAnalysisResults)
callPaths <- runGREAT(peaks = alteredPeaksCategorized)
enrichmentTables <- processPathways(callPaths, pathway_category = "GO",
enrichcutoff = 2, adjpvalcutoff = 0.05)
plotGREATenrich(enrichmentTables, maintitle = "GREAT Enrichment Analysis",
pathwaycateg = "GO_Molecular_Function")
writeBedFile(alteredPeaksCategorized, "altrecategpeaks.bed")
writeConsensusRE(consensusPeaksAnnotated, "altreconspeaks.csv")
writeCompareRE(comparePeaksAnalysisResults, "comparealtrepeaks.csv")
writeGREATpath(pathresults, "EnrichedPathways.zip")
View(TSSannot)
View(TSSannot)
View(samplePeaks)
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
library(ALTRE)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
class(samplePeaks)
loadbedfiles
loadBedFiles
source("~/.active-rstudio-document")
samplepeaks
samplePeaks
setwd("~/2022SpringCodingCamp/DarianWilliams/ALTREsampledata")
library(ALTRE)
library(GenomicRanges)
csvfile <- loadCSVFile("DNaseEncodeExample.csv")
csvfile
loadBedFiles_custom <- function (csvfile)
{
if (!is(csvfile, "data.frame"))
stop("csvfile must be a data.frame ")
readBed <- function(bedPath, ind) {
trackline <- utils::read.table(bedPath, nrows = 1, sep = "\t")
if (length(grep("track type", trackline$V1)) ==
0) {
bed <- DataFrame(readr::read_delim(bedPath, delim = "\t",
col_names = FALSE, na = "."))[, 1:3]
}
else {
bed <- DataFrame(readr::read_delim(bedPath, delim = "\t",
col_names = FALSE, na = ".", skip = 1))[,
1:3]
}
colnames(bed) <- c("seqnames", "start", "end")
bed <- DataFrame(bed, csvfile[ind, c("sample",
"replicate")])
bed <- within(bed, {
start <- start + 1L
sample <- factor(sample)
replicate <- factor(replicate)
})
return(bed)
}
bedFilesPath <- file.path(csvfile$datapath, csvfile$peakfiles)
bedFiles <- mapply(readBed, bedFilesPath, seq_along(bedFilesPath))
names(bedFiles) <- paste(csvfile$sample, csvfile$replicate,
sep = "_")
hotspots <- lapply(bedFiles, function(x) as(x, "GRanges"))
return(GRangesList(hotspots, compress = FALSE))
}
samplePeaks <- loadBedFiles(csvfile)
samplePeaks
consensusPeaks <- getConsensusPeaks(samplepeaks = samplePeaks,
minreps = 2)
